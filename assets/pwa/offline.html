---
layout: default
title: Offline
---

<div style="text-align: center; padding: 50px 20px;">
    <h1>{{ site.title | default: "Textbook" }} - Offline</h1>
    <p>You're currently offline, but you can still access cached content.</p>

    <div style="margin: 30px 0;">
        <h2>Available Sections</h2>
        <p>The following sections should be available offline:</p>
        <ul style="text-align: left; display: inline-block;">
            <li><a href="{{ site.baseurl }}/">Home Page</a></li>
            <li><a href="{{ site.baseurl }}/SUMMARY.html">Table of Contents</a></li>
            <li>Previously visited chapters</li>
        </ul>
    </div>

    <div style="margin: 30px 0;">
        <h2>Connection Status</h2>
        <p id="connection-status">Checking connection...</p>
        <button onclick="checkConnection()" style="background: #3367D6; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
            Try to Reconnect
        </button>
    </div>

    <div style="margin: 30px 0; font-size: 14px; color: #666;">
        <p><strong>Tip:</strong> When you're back online, new content will be automatically cached for offline use.</p>
    </div>
</div>

<script>
const BASE_URL = '{{ site.baseurl }}/';

function updateConnectionStatus() {
    const statusEl = document.getElementById('connection-status');
    if (navigator.onLine) {
        statusEl.innerHTML = 'Connected - You can access all content';
        statusEl.style.color = 'green';
        setTimeout(() => {
            window.location.href = BASE_URL;
        }, 2000);
    } else {
        statusEl.innerHTML = 'Offline - Limited content available';
        statusEl.style.color = 'red';
    }
}

function checkConnection() {
    updateConnectionStatus();
    if (navigator.onLine) {
        // Try to fetch a small resource to verify real connectivity
        fetch(BASE_URL + 'assets/image/favicon.ico', {
            method: 'HEAD',
            cache: 'no-cache'
        })
        .then(() => {
            window.location.href = BASE_URL;
        })
        .catch(() => {
            alert('Connection test failed. Please check your internet connection.');
        });
    } else {
        alert('No internet connection detected.');
    }
}

// Update status on load
updateConnectionStatus();

// Listen for connection changes
window.addEventListener('online', updateConnectionStatus);
window.addEventListener('offline', updateConnectionStatus);

// Check connection every 10 seconds
setInterval(updateConnectionStatus, 10000);
</script>
